# TDD

こう言う処理が必要だ、と言う時に、
その処理はこう言う実装が良いだろう、の様に考えず、まずテストを書く。

## 手順

1. 問題点を一つ取り上げる。
この問題点をこれから解消する。問題点が大き過ぎる場合、分割統治法の考え方で問題を小分けにし、その問題点について考える。

1. テストを書く。テストのビルドを通す。
こう言うのが必要、ここがダメだ、と言う感情を真っ先にテストにする。
空実装を用いてテストのビルド出来る状態にしてビルドする。
空実装は、常に何もしない実装、これ以上削るとビルドが通らなくなる実装である。とりあえず最低限の呼び出し引数と戻り値を返す実装を行う。これでビルドを通す。
ここから実装方法を考えたくなるが、それはまだ早い。

1. 直書きでテストを通す。
空実装をテストが通る値の直書き実装にして、テストを通す。
直書き実装はテストが通る最低限の実装で、
定数やtrueなどどう呼ばれても常に一定値を返す実装の事。
とりあえず大罪を犯しながらテストを通す。
兎に角直前に書いてテストが通る様にする。

1. 問題を一般化するテストを書く。
例えば等値をしていたならば不等値のチェックを行う、与えていた引数を他の引数にして呼び出すチェックなど、異なるテストを書く。
当然値の直書き実装ではテストが通らない。
このテストが通ればある程度一般化出来たと言える。
この様に2つの異なるテストで一般化を図る事を三角測量と呼んでいる。

1. テストを通す。
ここからようやく実装に入る。
直書きした値を変数に置き換える。
実装を修正したらテストが通るか確認する。

1. リファクタリング
ここで書いた実装をリファクタリングする。
その機能の実装としていい感じのコードにする。
ここでのポイントはすでに三角測量のできるテストを書いているので、リファクタリング前とリファクタリング後の実装が同じ振る舞いをする事が確かめられると言う事。

1. 意図を語るテストを作る。
リファクタリングが終わったら、ここまで書いてきたテストをより良くする。
その機能を使う他の開発者、その機能を拡張しようとしている開発者、その機能のバグを修正しようとしている開発者が、そのテストさえ見ればその機能の使い方、仕様、注意点が分かる様にする。つまり、テストが仕様を語る状態にする。

## まとめ

1. これから解決する問題を一つ取り上げる。
1. テストを先に書く。テストが失敗する事を確認する。
1. 最低限の実装でテストを通す。
1. テストを増やす。
1. 増えたテストが通る様に実装を一般化する。
1. 実装を修正し、テストを通す。
1. リファクタリングを行う。
1. 仕様を語るテストに修正する。

[![](https://www.plantuml.com/plantuml/svg/XLRTJjj85BxtKqHSbPNsPY_XfXVSzwOlmBQHjjekL41LhLOhUUmajME7K6W88PH02II4re6ohTA4mCECP-oynNwUCPE1184Y97k-ytFEzvtZURgwjhYozlQlryQBnPMNcPdd2mkK1DprHWU5cSm_XY7E3MEELSgZGvzQcyofShz6IVNviuLdrEvGwoUr7Ho4mptkR51IevPd6B_Yps3D5YMb4Lcd-5bUweDqcLDWxhVe-mN_Dk2N5KICJPiIXs__XAFeOvkI72KdxBmC92KVA3cJVkSDOoNx9hkubfb7JfHiKGl-F6gvSUk8N_GbIkKQzanAcgoyJQrYs2jIiebJQbhpiBKBAdEMTn21rtkKb74wFY8-QrxmIbMwHRYmxoK9Vkx7dP9y2Roi5QUK5E8s8YBb8B6zoSSdX9f47E7dKzkazY4b1-9bMu9vhi7jVE9shq79aKn6o-5i72WwxREW4H_bzIvfq83QMzI6iSlUz_cdOvX5nHyyxmalLO0LO9fJqaLUhDS3EXnMg6K9cmx2I01EPSl3mJ7QoToYw4fRS-gFp5sm8QpA-0_0hND8mKf3mWQC9Cy4MU_oFJCShezg44_0FbnHSedq4PjTLNZb763k381dPXDrnpSVaRjgGvm8gW2djs9egMnmYcm05Y451r8hqXXYW_O0ajgZfA5IHXsYra_2OvUIQt36gwVe17mbqjDJLWKg9bHafGwTkJ4iRPU7ok0dglydD5XAaOepaqptF67GdNGzFL6J62pOJPfhvTPMtcO5NwVYLn0CuC1FGbjMgeUU2OD91k0rx4_Z5ACV3Jj0HyNkhOnyz7vw9Io_ZY1nQnCbCRUKJgCkRxsareu-5Q33k3VFdwkeIsz_UEs9jCwZhwuiGhPMX6W8qbsSXhsI18XH8jG2fJQrkfhEY17saAkZZAL8WGW7sp2JZuexJSurtMFQSBYBW1QYqojGkyXWmwqez-C1WRGcA5V3brEY3oOGFagLmnYrFTO_0RcnyuNvs-dM88tRvUG0CtOa6_yR9IAPoRn9ItbAMAXVubHkpB3dWbpU-p9wNuRlf2lMbiW_DoPn3hp9GNo8SpL2Aixa4bPJJYsO5uGGocgYMFuunQjc2g8QKXMiwKhsec608rwkZtim3duJyAz7qWnn9fD5VFqJaQuCRVuxrCRYEHJAkX6FQDNv8zD-fy3MxNmq7dUhMeI5bh1useZjeROEsjeiv7WEvE_Wb5gNrBx26jLdRHnVw0hxiOaWelOkGEBzsLso0_6oD4tWkJGgZYGCu_1G5TWAxDhNilRPXezCkG-O5plxmj4caf2Y0m0S22KG8GOVxzKt5u2KbN1GWRPW6NVsxuhvBELvkiAkDGvEX8eQUdtKmlzYxA8hvR67Np8w1UBET8DivEOORNjHhH-R-KaOzmxPrNVG93MjKmRF3naAYZRGEwNPnptWinwtT_Hiq4ZfL6jD1LCHdtZf9Z79VMM9idBumE8iRR19-6MRvyeHN11VNEkyoLrkYDroZTRfOm03dQOxjnfzmkxUICKI20T5Lj_NRu0WIjuFaGdyuH8pgZNLxVBtnHT_liDD-BwlCrn112AzVhxxuzNhRER9p3rOC3h8H_M0vTl9xW_yi5z8zmJnPcOphrOpJvQMPpDBoskP9tzdLsUDEGcQnprx-Otnh_4qk_GIj_7_0G00
)](https://www.plantuml.com/plantuml/svg/XLRTJjj85BxtKqHSbPNsPY_XfXVSzwOlmBQHjjekL41LhLOhUUmajME7K6W88PH02II4re6ohTA4mCECP-oynNwUCPE1184Y97k-ytFEzvtZURgwjhYozlQlryQBnPMNcPdd2mkK1DprHWU5cSm_XY7E3MEELSgZGvzQcyofShz6IVNviuLdrEvGwoUr7Ho4mptkR51IevPd6B_Yps3D5YMb4Lcd-5bUweDqcLDWxhVe-mN_Dk2N5KICJPiIXs__XAFeOvkI72KdxBmC92KVA3cJVkSDOoNx9hkubfb7JfHiKGl-F6gvSUk8N_GbIkKQzanAcgoyJQrYs2jIiebJQbhpiBKBAdEMTn21rtkKb74wFY8-QrxmIbMwHRYmxoK9Vkx7dP9y2Roi5QUK5E8s8YBb8B6zoSSdX9f47E7dKzkazY4b1-9bMu9vhi7jVE9shq79aKn6o-5i72WwxREW4H_bzIvfq83QMzI6iSlUz_cdOvX5nHyyxmalLO0LO9fJqaLUhDS3EXnMg6K9cmx2I01EPSl3mJ7QoToYw4fRS-gFp5sm8QpA-0_0hND8mKf3mWQC9Cy4MU_oFJCShezg44_0FbnHSedq4PjTLNZb763k381dPXDrnpSVaRjgGvm8gW2djs9egMnmYcm05Y451r8hqXXYW_O0ajgZfA5IHXsYra_2OvUIQt36gwVe17mbqjDJLWKg9bHafGwTkJ4iRPU7ok0dglydD5XAaOepaqptF67GdNGzFL6J62pOJPfhvTPMtcO5NwVYLn0CuC1FGbjMgeUU2OD91k0rx4_Z5ACV3Jj0HyNkhOnyz7vw9Io_ZY1nQnCbCRUKJgCkRxsareu-5Q33k3VFdwkeIsz_UEs9jCwZhwuiGhPMX6W8qbsSXhsI18XH8jG2fJQrkfhEY17saAkZZAL8WGW7sp2JZuexJSurtMFQSBYBW1QYqojGkyXWmwqez-C1WRGcA5V3brEY3oOGFagLmnYrFTO_0RcnyuNvs-dM88tRvUG0CtOa6_yR9IAPoRn9ItbAMAXVubHkpB3dWbpU-p9wNuRlf2lMbiW_DoPn3hp9GNo8SpL2Aixa4bPJJYsO5uGGocgYMFuunQjc2g8QKXMiwKhsec608rwkZtim3duJyAz7qWnn9fD5VFqJaQuCRVuxrCRYEHJAkX6FQDNv8zD-fy3MxNmq7dUhMeI5bh1useZjeROEsjeiv7WEvE_Wb5gNrBx26jLdRHnVw0hxiOaWelOkGEBzsLso0_6oD4tWkJGgZYGCu_1G5TWAxDhNilRPXezCkG-O5plxmj4caf2Y0m0S22KG8GOVxzKt5u2KbN1GWRPW6NVsxuhvBELvkiAkDGvEX8eQUdtKmlzYxA8hvR67Np8w1UBET8DivEOORNjHhH-R-KaOzmxPrNVG93MjKmRF3naAYZRGEwNPnptWinwtT_Hiq4ZfL6jD1LCHdtZf9Z79VMM9idBumE8iRR19-6MRvyeHN11VNEkyoLrkYDroZTRfOm03dQOxjnfzmkxUICKI20T5Lj_NRu0WIjuFaGdyuH8pgZNLxVBtnHT_liDD-BwlCrn112AzVhxxuzNhRER9p3rOC3h8H_M0vTl9xW_yi5z8zmJnPcOphrOpJvQMPpDBoskP9tzdLsUDEGcQnprx-Otnh_4qk_GIj_7_0G00)